{
  "$schema": "http://json-schema.org/draft/2019-09/schema#",
  "title": "Vulnerability Disclosure Metadata",
  "type": "object",
  "properties": {
    "overview": {
      "summary": { "type": "string" },
      "details": { "type": "string" },
      "recommendation": { "type": "string" },
      "cve": {
        "type": "string",
        "pattern": "/^CVE-[0-9]{4}-[0-9]{5}$/i"
      },
      "advisory": {
        "type": "string",
        "format": "uri"
      },
      "timeline": {
        "type": "object",
        "properties": {
          "submitted": {
            "type": "string",
            "format": "date"
          },
          "triaged": {
            "type": "string",
            "format": "date"
          },
          "resolved": {
            "type": "string",
            "format": "date"
          },
          "disclosed": {
            "type": "string",
            "format": "date"
          }
        }
      },
      "required": ["summary", "details", "recommendation", "cve"]
    },
    "identity": {
       "package_name": {
          "type": "string",
          "description": "Name of the affected software package, if it exists.",
          "minLength": 1
       },
       "package_ecosystem": {
         "type": "string",
         "description": "If a package_name is provided, the ecosystem from which the package originates.",
         "enum": [
           "brew",
           "cabal",
           "cargo",
           "ccan",
           "chocolatey",
           "clojars",
           "cocoapods",
           "composer",
           "conan",
           "conda",
           "cpan",
           "cran",
           "ctan",
           "deb",
           "docker",
           "elm",
           "gem",
           "gitsubmodule",
           "gomod",
           "hex",
           "ivy",
           "maven",
           "npm",
           "nuget",
           "pypi",
           "rpm",
           "swift",
           "terraform",
           "vcpkg",
           "other"
        ]
      },
      "versions": {
        "type": "array",
        "description": "",
        "minItems": 1,
        "uniqueItems": true,
        "items": {
          "type": "object",
          "description": "Affected/non-affected/fixed versions of a given technology, product, hardware, etc.",
          "required": ["version_value"],
          "properties": {
            "version_value": {
              "type": "string",
              "description": "The version name/value (e.g. 10.0, 3.1, \"IceHouse\")",
              "minLength": 1
            },
            "version_affected": {
              "type": "string",
              "description": "A string value:\n \"=\" (affects version_value),\n \"<\" (affects versions prior to version_value),\n \">\" (affects versions later than version_value),\n \"<=\" (affects version_value and prior versions),\n \">=\" (affects version_value and later versions),\n \"!\" (doesn't affect version_value),\n \"!<\" (doesn't affect versions prior to version_value),\n \"!>\" (doesn't affect versions later than version_value),\n \"!<=\" (doesn't affect version_value and prior versions),\n \"!>=\" (doesn't affect version_value and later versions),\n \"?\" (status of version_value is unknown),\n \"?<\" (status of versions prior to version_value is unknown),\n \"?>\" (status of versions later than version_value is unknown),\n \"?<=\" (status of version_value and prior versions is unknown),\n \"?>=\" (status of version_value and later versions is unknown)",
              "enum": [
                 "=",
                 "<",
                 ">",
                 "<=",
                 ">=",
                 "!",
                 "!<",
                 "!>",
                 "!<=",
                 "!>=",
                 "?",
                 "?<",
                 "?>",
                 "?<=",
                 "?>="
              ]
            }
          }
        }
      },
      "swid": {"type": "string"},
      "repository": {
        "type": "string",
        "format": "uri"
      },
      "introduced_in": {
        "type": "object",
        "properties": {
          "commit": { "type": "string" },
          "repo_type": { "type": "string" },
          "repo_url": {
            "type": "string",
            "format": "uri"
          }
        }
      },
      "reproduction": {
        "type": "string",
        "format": "uri"
      },
      "required": ["package_name", "versions", "repository"]
    },
    "impact": {
      "severity": {
        "type": "string",
        "enum": ["Critical", "High", "Medium", "Low"]
      },
      "cvss": {
        "type": "object",
        "properties": {
          "vector": { "type": "string" },
          "score": { "type": "number" }
        }
      },
      "cwe": { "type": "string" },
      "impacted_methods": {
        "type": "array",
        "items": {
          "type": "string"
        }
      },
      "impacted_apis": {
        "type": "array",
        "items": {
          "type": "string"
        }
      },
      "required": ["severity", "cvss", "cwe"]
    },
    "remediation": {
      "details": { "type": "string" },
      "patch_link": {
        "type": "string",
        "format": "uri"
      },
      "fixed_in": {
        "type": "object",
        "properties": {
          "releases": {
            "type": "array",
            "items": { "type": "string" }
          },
          "commit": { "type": "string" },
          "repo_type": { "type": "string" },
          "repo_url": {
            "type": "string",
            "format": "uri"
          }
        }
      },
      "required": ["details", "fixed_in"]
    },
    "references": {
      "type": "array",
      "items": {
        "type": "string",
        "format": "uri"
      }
    },
    "required": ["overview", "identity", "impact", "remediation"]
  }
}
